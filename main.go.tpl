// Code generated by protoc-gen-mcp. DO NOT EDIT.
// versions:
//  - protoc-gen-mcp {{ .PluginVersion }}
//  - protoc         TODO
// source: TODO

package {{ .GoPackageName }}

import (
    {{ if .Tools }}"context"
    {{ end }}
    "github.com/mark3labs/mcp-go/server"
    {{ if .Tools }}"github.com/mark3labs/mcp-go/mcp"
    "google.golang.org/protobuf/encoding/protojson"{{ end }}
)

func New{{.Name}}MCPServer(client {{ .Name }}Client) *server.MCPServer {
    s := server.NewMCPServer(
        "{{ .Name }}",
        "{{ .Version }}",
    )

    {{ range .Tools }}
    {{ .Name }}Tool := mcp.NewTool("{{ .Name }}",
        {{ if .Description }}mcp.WithDescription("{{ .Description }}"),{{ end }}
    )
    s.AddTool({{ .Name }}Tool, func(ctx context.Context, request mcp.CallToolRequest) (*mcp.CallToolResult, error) {
        in := &{{ .InputMessageName }}{}

        out, err := client.{{ .Name }}(ctx, in)
        if err != nil {
            return mcp.NewToolResultError(err.Error()), nil
        }

        return mcp.NewToolResultText(protojson.Format(out)), nil
    })
    {{ end }}

   return s
}
